<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content=""/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@corrieaar"/>



  	<meta property="og:title" content=" &middot; Samples of Thoughts" />
  	<meta property="og:site_name" content="Samples of Thoughts" />
  	<meta property="og:url" content="/projects/statistical-rethinking/chapter_7/chapter7_ex/" />

    
        
            <meta property="og:image" content="/images/tea_with_books.jpg"/>
        
    
    
    <meta property="og:description" content="" />
  	<meta property="og:type" content="article" />
    <meta property="article:published_time" content="0001-01-01T00:00:00Z" />

    
    

    <title> &middot; Samples of Thoughts</title>

    
    <meta name="description" content="Chapter 7 - Exercises Corrie August 17, 2018
Chapter 7 - Exercises Easy. 7E1. For the causal relationships below, name a hypothetical third variable that would " />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/images/favicon.ico">
	  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="/css/nav.css" />

    
    
    


<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/googlecode.min.css' rel='stylesheet' type='text/css' />



  
     
      
          <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Samples of Thoughts" />
      
      
    
    <meta name="generator" content="Hugo 0.55.5" />

    <link rel="canonical" href="/projects/statistical-rethinking/chapter_7/chapter7_ex/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name":  null 
    },
    "author": {
        "@type": "Person",
        "name":  null ,
        
        "url":  null ,
        "sameAs": [
            
            
             
             
             
             
             
            
        ]
    },
    "headline": "",
    "name": "",
    "wordCount":  5091 ,
    "timeRequired": "PT24M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": "en"
    },
    "url": "/projects/statistical-rethinking/chapter_7/chapter7_ex/",
    "datePublished": "0001-01-01T00:00Z",
    "dateModified": "0001-01-01T00:00Z",
    
    
    "description": "",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "/projects/statistical-rethinking/chapter_7/chapter7_ex/"
    }
}
    </script>
    


    

    
<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-140745376-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>


    
    
    




<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#40485A",
          "text": "#ffffff"
        },
        "button": {
          "background": "#5B5A68",
          "text": "#ffffff"
        }
      },
      "content": {
        "message": "This website uses cookies to ensure you get the best experience on my website.",
        "dismiss": "Got it!",
        "link": "Learn more",
        "href": "https://cookies.insites.com"
      }
    })});
</script>


</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/projects">Projects</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/talks">Talks</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/about">About</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/">Home</a>
            </li>
        
        
    </ul>

    
    <a class="subscribe-button icon-feed" href="/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">



<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">



      <ul>
        
			<li> <a class="blog-logo" href="/">Home</a> </li>
			  
			<li> <a class="blog-logo" href="/about">About</a> </li>
			  
			<li> <a class="blog-logo" href="/talks">Talks</a> </li>
			  
			<li> <a class="blog-logo" href="/projects">Projects</a> </li>
			  

            
              <a class="menu-button icon-feed" href="">&nbsp;&nbsp;Subscribe</a>
            
            
      
       </ul>
    </nav>
    
     <div class="vertical">
        <div class="main-header-content inner">
            


    <a class="bloglogo" href="https://github.com/corriebar" target="_blank">
    <span class="icon-github" style="color:white;font-size:2em"></span>
    </a>
&nbsp;









    <a class="bloglogo" href="https://twitter.com/corrieaar" target="_blank">
        <span class="icon-twitter" style="color:white;font-size:2em"></span>
    </a>
&nbsp;














            <h1 class="page-title">Samples of Thoughts</h1>
            <h2 class="page-description">about data, statistics  and everything in between</h2>
        </div>
    </div>  
    


</header>



<main class="content" role="main">




  <article class="post projects">

    <header class="post-header">
        <h1 class="post-title"></h1>
        <small></small>

        <section class="post-meta">
        
            <p class="post-reading post-line">
            <span>Estimated reading time: 24 min</span>
            </p>
        
        
        
         
        </section>
    </header>

    <section class="post-content">
      

<h1 id="chapter-7-exercises">Chapter 7 - Exercises</h1>

<p>Corrie
August 17, 2018</p>

<h1 id="chapter-7-exercises-1">Chapter 7 - Exercises</h1>

<h2 id="easy">Easy.</h2>

<p><strong>7E1.</strong> For the causal relationships below, name a hypothetical third variable that would lead to an interaction effect.</p>

<ol>
<li>Bread dough rises because of yeast.</li>
</ol>

<ul>
<li>sugar, since the yeast needs some food to grow</li>
<li>temperature, if it&rsquo;s too hot, the yeast dies, maybe a too cold temperature would slow down the dough rising</li>
<li>salt inhibits yeast growth</li>
</ul>

<ol>
<li>Education leads to higher income.</li>
</ol>

<ul>
<li>class and race could potentially strengthen or weaken the impact of education in income</li>
<li>same for gender</li>
</ul>

<ol>
<li>Gasoline makes a car go.</li>
</ol>

<ul>
<li>Number of cylinders, age of motor, weight of the car all have an effect of how far a car can go with one liter of gasoline</li>
<li>Presence of wheels is a trivial interaction: you can pour as much gasoline as you want, the car won&rsquo;t drive without wheels</li>
</ul>

<p><strong>7E2.</strong> Which of the following explanations invokes an interaction?</p>

<ol>
<li>Caramelizing onions requires cooking over low heat and making sure the onions do not dry out</li>
</ol>

<ul>
<li>caramelizing invokes an interaction between heat and humidity</li>
</ul>

<ol>
<li>A car will go faster when it has more cylinders or when it has a better fuel injector</li>
</ol>

<ul>
<li>no interaction; the or indicates the two are independently making a car faster</li>
</ul>

<ol>
<li>Most people acquire their political beliefs from their parents, unless they get them instead from their friends.</li>
</ol>

<ul>
<li>This explanation does invoke an interaction insofar that if someone get their political beliefs from their friends, they don&rsquo;t get it from their parents (and vice versa)</li>
</ul>

<ol>
<li>Intelligent animal species tend to be either highly social or have manipulative appendages</li>
</ol>

<ul>
<li>The or again indicates no interaction (unless you interpret the or as an exclusive or). Though I could also imagine there to be an interaction: if a species has manipulative appendages, then the degree of socialness might have an higher impact on intelligence</li>
</ul>

<p><strong>7E3.</strong> Write a linear model for the explanations above.</p>

<ol>
<li><p>Caramelizing onions requires cooking over low heat and making sure the onions do not dry out. We assume caramelizing can be quantified as some degree, to how much the onions are caramelized.</p>

<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%2A%7D%0A%5Ctext%7BCaramelized%7D_i%20%26%5Csim%20%5Ctext%7BNormal%7D%28%20%5Cmu_i%2C%20%5Csigma%29%20%5C%5C%0A%5Cmu_i%20%26%3D%20%5Calpha%20%2B%20%5Cbeta_%7Bh%7D%5Ctext%7Bheat%7D_i%20%2B%20%5Cbeta_d%5Ctext%7Bdryness%7D_i%20%2B%20%5Cbeta_%7Bhd%7D%5Ctext%7Bheat%7D_i%20%5Ctimes%20%5Ctext%7Bdryness%7D_i%0A%5Cend%7Balign%2A%7D &quot;begin{align*}
text{Caramelized}_i &amp;sim text{Normal}( mu_i, sigma" alt="\\begin{align\*}
\\text{Caramelized}\_i &amp;\\sim \\text{Normal}( \\mu\_i, \\sigma) \\\\
\\mu\_i &amp;= \\alpha + \\beta\_{h}\\text{heat}\_i + \\beta\_d\\text{dryness}\_i + \\beta\_{hd}\\text{heat}\_i \\times \\text{dryness}\_i
\\end{align\*}" /> <br />
\mu<em>i &amp;= \alpha + \beta</em>{h}\text{heat}_i + \beta_d\text{dryness}<em>i + \beta</em>{hd}\text{heat}_i \times \text{dryness}_i
\end{align*}&ldquo;)</p></li>

<li><p>A car will go faster when it has more cylinders or when it has a better fuel injector.</p>

<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%2A%7D%0A%5Ctext%7BSpeed%7D_i%20%26%5Csim%20%5Ctext%7BNormal%7D%28%5Cmu_i%2C%20%5Csigma%29%20%5C%5C%0A%5Cmu_i%20%26%3D%20%5Calpha%20%2B%20%5Cbeta_c%5Ctext%7Bcylinders%7D_i%20%2B%20%5Cbeta_f%5Ctext%7Bfuel%20injector%7D_i%0A%5Cend%7Balign%2A%7D &quot;begin{align*}
text{Speed}_i &amp;sim text{Normal}(mu_i, sigma" alt="\\begin{align\*}
\\text{Speed}\_i &amp;\\sim \\text{Normal}(\\mu\_i, \\sigma) \\\\
\\mu\_i &amp;= \\alpha + \\beta\_c\\text{cylinders}\_i + \\beta\_f\\text{fuel injector}\_i
\\end{align\*}" /> <br />
\mu_i &amp;= \alpha + \beta_c\text{cylinders}_i + \beta_f\text{fuel injector}_i
\end{align*}&ldquo;)</p></li>

<li><p>Most people acquire their political beliefs from their parents, unless they get them instead from their friends. We first assume that political belief can be modeled as a number from minus infinity to plus infinity, where zero is moderate (also assuming most people are moderate, thus we can assume normal distribution), negative is left-leaning and positive right-leaning. We also introduce an indicator variable <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BBelief%20source%7D" alt="\\text{Belief source}" title="\text{Belief source}" /> that is 0 if the political belief is acquired from the parents and 1 if from the friends. Assuming a strict exclusive-or relationship, the linear model would look like this:</p>

<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%2A%7D%0A%5Ctext%7BPolitcal%20belief%7D_i%20%26%5Csim%20%5Ctext%7BNormal%7D%28%5Cmu_i%2C%20%5Csigma%29%20%5C%5C%0A%5Cmu_i%20%26%3D%20%5Calpha%20%2B%20%5Cbeta_%7Bsp%7D%5Ctext%7BParents%20belief%7D_i%20%281-%20%5Ctext%7BBelief%20source%7D_i%29%20%5C%5C%0A%26%5Cquad%20%5Cquad%20%2B%20%5Cbeta_%7Bsf%7D%5Ctext%7BBelief%20source%7D_i%20%5Ctimes%20%5Ctext%7BFriends%20belief%7D_i%0A%5Cend%7Balign%2A%7D &quot;begin{align*}
text{Politcal belief}_i &amp;sim text{Normal}(mu_i, sigma" alt="\\begin{align\*}
\\text{Politcal belief}\_i &amp;\\sim \\text{Normal}(\\mu\_i, \\sigma) \\\\
\\mu\_i &amp;= \\alpha + \\beta\_{sp}\\text{Parents belief}\_i (1- \\text{Belief source}\_i) \\\\
&amp;\\quad \\quad + \\beta\_{sf}\\text{Belief source}\_i \\times \\text{Friends belief}\_i
\\end{align\*}" /> <br />
\mu<em>i &amp;= \alpha + \beta</em>{sp}\text{Parents belief}_i (1- \text{Belief source}<em>i) <br />
&amp;\quad \quad + \beta</em>{sf}\text{Belief source}_i \times \text{Friends belief}_i
\end{align*}&ldquo;)</p></li>

<li><p>Intelligent animal species tend to be either highly social or have manipulative appendages.</p>

<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%2A%7D%0A%5Ctext%7BIntelligence%7D_i%20%26%5Csim%20%5Ctext%7BNormal%7D%28%5Cmu_i%2C%20%5Csigma%29%20%5C%5C%0A%5Cmu_i%20%26%3D%20%5Calpha%20%2B%20%5Cbeta_s%5Ctext%7BSocialness%7D_i%20%2B%20%5Cbeta_a%20%5Ctext%7BAppendages%7D_i%0A%5Cend%7Balign%2A%7D &quot;begin{align*}
text{Intelligence}_i &amp;sim text{Normal}(mu_i, sigma" alt="\\begin{align\*}
\\text{Intelligence}\_i &amp;\\sim \\text{Normal}(\\mu\_i, \\sigma) \\\\
\\mu\_i &amp;= \\alpha + \\beta\_s\\text{Socialness}\_i + \\beta\_a \\text{Appendages}\_i
\\end{align\*}" /> <br />
\mu_i &amp;= \alpha + \beta_s\text{Socialness}_i + \beta_a \text{Appendages}_i
\end{align*}&ldquo;)</p></li>
</ol>

<h2 id="medium">Medium.</h2>

<p><strong>7M1.</strong> The tulips example. Suppose another set of treatments adjusted the temperature in the greenhouse over two levels: cold and hot. The data before were all collected at the cold temperature. You find none of the plants grown under the hot temperature developed any blooms at all, regardless of the water and shade levels. What does this mean in terms of interactions?</p>

<p>This would mean that temperature interacts with both water and shade, basically setting their effect to zero if it&rsquo;s hot.</p>

<p><strong>7M2.</strong> A regression equation for the example above could look as follows:</p>

<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%2A%7D%0A%5Ctext%7BBlooms%7D_i%20%26%5Csim%20%5Ctext%7BNormal%7D%28%5Cmu_i%2C%20%5Csigma%29%20%5C%5C%0A%5Cmu_i%20%26%3D%20%5Calpha%20%2B%20%20%5Ctext%7BTemperature%7D_i%28%20%5Cbeta_%7Bst%7D%20%5Ctext%7BShade%7D_i%20%2B%20%5Cbeta_%7Bwt%7D%20%5Ctext%7BWater%7D_i%20%2B%20%5Cbeta_%7Bwst%7D%5Ctext%7BWater%7D_i%20%5Ctimes%20%5Ctext%7BShade%7D_i%29%20%5C%5C%0A%26%5Cquad%20%5Cquad%20%2B%20%5Cbeta_s%20%5Ctext%7BShade%7D_i%20%2B%20%5Cbeta_w%20%5Ctext%7BWater%7D_i%20%2B%20%5Cbeta%7Bws%7D%20%5Ctext%7BWater%7D_i%20%5Ctimes%20%5Ctext%7BShade%7D_i%20%2B%20%5Cbeta_t%20%5Ctext%7BTemperature%7D_i%0A%5Cend%7Balign%2A%7D &quot;begin{align*}
text{Blooms}_i &amp;sim text{Normal}(mu_i, sigma" alt="\\begin{align\*}
\\text{Blooms}\_i &amp;\\sim \\text{Normal}(\\mu\_i, \\sigma) \\\\
\\mu\_i &amp;= \\alpha +  \\text{Temperature}\_i( \\beta\_{st} \\text{Shade}\_i + \\beta\_{wt} \\text{Water}\_i + \\beta\_{wst}\\text{Water}\_i \\times \\text{Shade}\_i) \\\\
&amp;\\quad \\quad + \\beta\_s \\text{Shade}\_i + \\beta\_w \\text{Water}\_i + \\beta{ws} \\text{Water}\_i \\times \\text{Shade}\_i + \\beta\_t \\text{Temperature}\_i
\\end{align\*}" /> <br />
\mu_i &amp;= \alpha +  \text{Temperature}<em>i( \beta</em>{st} \text{Shade}<em>i + \beta</em>{wt} \text{Water}<em>i + \beta</em>{wst}\text{Water}_i \times \text{Shade}_i) <br />
&amp;\quad \quad + \beta_s \text{Shade}_i + \beta_w \text{Water}_i + \beta{ws} \text{Water}_i \times \text{Shade}_i + \beta_t \text{Temperature}_i
\end{align*}&ldquo;)</p>

<p>where <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BTemperature%7D" alt="\\text{Temperature}" title="\text{Temperature}" /> is 1 when it&rsquo;s hot and 0 when it&rsquo;s cold. If then <img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7Bst%7D%20%3D%20-%20%5Cbeta_s" alt="\\beta\_{st} = - \\beta\_s" title="\beta_{st} = - \beta_s" />, <img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7Bwt%7D%20%3D%20-%5Cbeta_w" alt="\\beta\_{wt} = -\\beta\_w" title="\beta_{wt} = -\beta_w" />, <img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7Bwst%7D%20%3D%20-%5Cbeta_%7Bws%7D" alt="\\beta\_{wst} = -\\beta\_{ws}" title="\beta_{wst} = -\beta_{ws}" /> and <img src="https://latex.codecogs.com/png.latex?%5Cbeta_t%20%3D%20-%5Calpha" alt="\\beta\_t = -\\alpha" title="\beta_t = -\alpha" /> then the whole equation is 0 when it&rsquo;s hot and the same as before when it&rsquo;s cold.</p>

<p><strong>7M3.</strong> In parts of america, ravens depend upon wolves for their food. Such a species relationship is generally described as a &ldquo;species interaction&rdquo;. How could a hypothetical set of data on raven population size look like in which this relationship would manifest as a statistical interaction? Do you think the biological interaction could be linear? Why or why not?</p>

<p>The regression equation could look like this:</p>

<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%2A%7D%0A%5Ctext%7BRavens%7D%20%26%5Csim%20%5Ctext%7BNormal%7D%28%5Cmu%2C%20%5Csigma%20%29%20%5C%5C%0A%5Cmu%20%26%3D%20%5Calpha%20%2B%20%5Cbeta_p%20%5Ctext%7BPrey%7D%20%2B%20%5Cbeta_w%5Ctext%7BWolves%7D%20%2B%20%5Cbeta_%7Bpw%7D%5Ctext%7BPrey%7D%20%5Ctimes%20%5Ctext%7BWolves%7D%0A%5Cend%7Balign%2A%7D &quot;begin{align*}
text{Ravens} &amp;sim text{Normal}(mu, sigma" alt="\\begin{align\*}
\\text{Ravens} &amp;\\sim \\text{Normal}(\\mu, \\sigma ) \\\\
\\mu &amp;= \\alpha + \\beta\_p \\text{Prey} + \\beta\_w\\text{Wolves} + \\beta\_{pw}\\text{Prey} \\times \\text{Wolves}
\\end{align\*}" /> <br />
\mu &amp;= \alpha + \beta_p \text{Prey} + \beta<em>w\text{Wolves} + \beta</em>{pw}\text{Prey} \times \text{Wolves}
\end{align*}&ldquo;)</p>

<p>where <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BRavens%7D" alt="\\text{Ravens}" title="\text{Ravens}" /> is the amount of ravens in an area, <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BWolves%7D" alt="\\text{Wolves}" title="\text{Wolves}" /> the amount of wolves and <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BPrey%7D" alt="\\text{Prey}" title="\text{Prey}" /> is the amount of available prey.</p>

<p>A data set could look like this:</p>

<pre><code class="language-r">prey &lt;- as.integer(rnorm(100, mean=50, sd=15) ) # as.integer, so we have &quot;whole&quot; animals
wolves &lt;- as.integer(rnorm(100, mean=25, sd=7))
ravens &lt;- as.integer(rnorm(100, mean= 5 + 0.3*prey + -1*wolves + 0.4*wolves*prey, sd=9))

d &lt;- data.frame(prey=prey, wolves=wolves, ravens=ravens)
par(mfrow=c(1,2))
plot(ravens ~ prey, data=d)
plot(ravens ~ wolves, data=d)
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-1-1.png" alt="" /></p>

<p>The biological interaction is probably not linear, since both the amount of prey and predator (wolves and ravens) depend upon each other. The more prey there is, the more predator are there and the more predator there are, the less prey there is.</p>

<h2 id="hard">Hard.</h2>

<p><strong>7H1.</strong> Return to the tulips data and include the <code>bed</code> variable.</p>

<pre><code class="language-r">library(rethinking)
data(tulips)
d &lt;- tulips
d$bed_id &lt;- coerce_index(d$bed) 
d$shade.c &lt;- d$shade - mean(d$shade)
d$water.c &lt;- d$water - mean(d$water)

m7.1 &lt;- map(
  alist(
    blooms ~ dnorm(mu, sigma),
    mu &lt;- a + a_bed[bed_id] + bW*water.c + bS*shade.c + bWS*water.c*shade.c,
    a ~ dnorm(130, 100),
    a_bed[bed_id] ~ dnorm(0, 10),
    sigma ~ dunif(0, 100)
  ), 
  data=d,
  start=list(a=mean(d$blooms), a_bed=0, bW=0, bS=0, bWS=0, sigma=sd(d$blooms))
)
precis( m7.1 , depth = 2)
</code></pre>

<pre><code>##            Mean StdDev   5.5%  94.5%
## a        129.01   9.88 113.22 144.79
## a_bed[1] -10.79   9.03 -25.22   3.63
## a_bed[2]   4.59   8.84  -9.53  18.71
## a_bed[3]   6.18   8.87  -8.00  20.35
## bW        75.79   9.89  59.99  91.59
## bS       -41.60   9.89 -57.40 -25.79
## bWS      -52.81  12.11 -72.16 -33.45
## sigma     41.95   5.98  32.40  51.50
</code></pre>

<p><strong>7H2.</strong> Compare the model above with one that omits <code>bed</code> using WAIC. What do you infer from this comparison? Can you reconcile the WAIC results with the posterior distribution of the bed coefficients?</p>

<pre><code class="language-r">m7.2 &lt;- map(
  alist(
    blooms ~ dnorm( mu, sigma),
    mu &lt;- a + bW*water.c + bS*shade.c + bWS*water.c*shade.c,
    a ~ dnorm(130, 100),
    c(bW, bS, bWS) ~ dnorm( 0, 10),
    sigma ~ dunif(0, 100)
  ),
  data=d,
  start=list(a=mean(d$blooms), bW=0, bS=0, bWS=0, sigma=sd(d$blooms))
)
precis(m7.2)
</code></pre>

<pre><code>##         Mean StdDev   5.5%  94.5%
## a     129.02  14.50 105.85 152.19
## bW     17.89   9.79   2.24  33.53
## bS     -9.82   9.07 -24.31   4.67
## bWS    -9.08   9.42 -24.13   5.97
## sigma  76.14  12.26  56.55  95.73
</code></pre>

<pre><code class="language-r">plot( coeftab(m7.1, m7.2) )
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-4-1.png" alt="" /></p>

<p>Estimates for all parameters are pretty much the same for the parameters included in both models. The index variables for the <code>bed</code> variable are all very close to zero.</p>

<pre><code class="language-r">compare( m7.1, m7.2 )
</code></pre>

<pre><code>##       WAIC pWAIC dWAIC weight    SE   dSE
## m7.1 294.0   7.6   0.0      1 10.17    NA
## m7.2 316.7   3.1  22.7      0  9.00 12.69
</code></pre>

<p>The two models have almost the same WAIC and similar weights. Indeed, running the function a few times gives sometimes the first model as having the lower WAIC and sometimes the second model as having lower WAIC. Also, both models have more or less the same number of parameters estimated by WAIC and similar amounts of weight.</p>

<pre><code class="language-r">plot( compare( m7.1, m7.2 ))
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-6-1.png" alt="" /></p>

<p>Let&rsquo;s have a closer look at the posterior distribution of the index variables.</p>

<pre><code class="language-r">post &lt;- extract.samples( m7.1 )
post.a_bed &lt;- as.data.frame(post$a_bed)
colnames(post.a_bed) &lt;- c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)
dens(post.a_bed$a)
dens(post.a_bed$b, add=T, col=&quot;steelblue&quot;)
dens(post.a_bed$c, add=T, col=col.desat(&quot;red&quot;))
abline(v=0, lty=2, col=&quot;grey&quot;)
legend('topright', lty=c(1,1,1), col=c(&quot;black&quot;, &quot;steelblue&quot;, col.desat(&quot;red&quot;)), 
       legend=c(&quot;bed a&quot;, &quot;bed b&quot;, &quot;bed c&quot;), bty=&quot;n&quot;)
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-7-1.png" alt="" /></p>

<p>All three index parameter have most of their posterior density around 0. It&rsquo;s not even clear if the parameters should be positive or negative and there is a large uncertainty regarding the influence of the <code>bed</code> variable. In particular, the bed parameters for bed b and c appear to have the same distribution. Maybe it could be helpful to recode the levels, i.e. to merge b and c to one level. In my opinion, such recoding of levels should be driven by domain knowledge and not by results of models.</p>

<p>This also explains why the WAIC of the two models are basically the same.</p>

<p><strong>7H3.</strong> Consider again the <code>rugged</code> data on economic development and terrain ruggedness. There is one African country in the list, Seychelles, that has both a relatively high GDP and high ruggedness. Seychelles are a group of islands, far from mainland Africa, and it is highly touristic.</p>

<pre><code class="language-r">data(&quot;rugged&quot;)
d &lt;- rugged
d &lt;- d[complete.cases(d$rgdppc_2000),]
d$log_gdp &lt;- log(d$rgdppc_2000)
plot(log_gdp ~ rugged, data=d[d$cont_africa==0,], 
     ylim=c(min(d$log_gdp) - 0.5, max(d$log_gdp)),
     main=&quot;GDP versus Ruggedness&quot;,
     ylab=&quot;log(GDP)&quot;, xlab=&quot;Ruggedness Index&quot;)
points(log_gdp ~ rugged, data=d[d$cont_africa==1,], col=&quot;steelblue&quot;)
points(log_gdp ~ rugged, data=d[d$country==&quot;Seychelles&quot;,], col=col.desat(&quot;red&quot;))
text(d[d$country==&quot;Seychelles&quot;, &quot;rugged&quot;], d[d$country==&quot;Seychelles&quot;, &quot;log_gdp&quot;], 
     labels=&quot;Seychelles&quot;, pos=1, col=col.desat(&quot;red&quot;))
legend(&quot;bottomright&quot;, col=c(&quot;black&quot;, &quot;steelblue&quot;, col.desat(&quot;red&quot;)), 
       bty=&quot;n&quot;, legend=c(&quot;Non-Africa&quot;, &quot;Africa&quot;, &quot;Seychelles&quot;),
       pch=c(1,1,1))
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-8-1.png" alt="" /></p>

<p>It might be, that this one nation is exerting a strong influence on the conclusion from before, that high terrain ruggedness leads to higher GDP in Africa but lower outside Africa. We will now re-evaluate this hypothesis without the Seychelles.</p>

<ol>
<li>Does it still seem like the effect of ruggedness depends upon continent? How much has the expected relationship changed?</li>
</ol>

<pre><code class="language-r">d1 &lt;- d[d$country != &quot;Seychelles&quot;,]

m7.1 &lt;- map(
  alist(
    log_gdp ~ dnorm(mu, sigma),
    mu &lt;- a + bA*cont_africa + bR*rugged + bAR*rugged*cont_africa,
    a ~ dnorm( 8, 100),
    bA ~ dnorm(0, 1),
    bR ~ dnorm(0, 1),
    bAR ~ dnorm( 0, 1),
    sigma ~ dunif( 0, 10)
  ), data=d1
)
precis(m7.1)
</code></pre>

<pre><code>##        Mean StdDev  5.5% 94.5%
## a      9.19   0.14  8.97  9.40
## bA    -1.78   0.22 -2.13 -1.43
## bR    -0.19   0.08 -0.31 -0.07
## bAR    0.25   0.14  0.04  0.47
## sigma  0.93   0.05  0.85  1.01
</code></pre>

<pre><code class="language-r">plot( precis( m7.1 ))
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-10-1.png" alt="" /></p>

<p>Compare with the model on the full data:</p>

<pre><code class="language-r">m7.2 &lt;- map(
  alist(
    log_gdp ~ dnorm(mu, sigma),
    mu &lt;- a + bA*cont_africa + bR*rugged + bAR*rugged*cont_africa,
    a ~ dnorm( 8, 100),
    bA ~ dnorm(0, 1),
    bR ~ dnorm(0, 1),
    bAR ~ dnorm( 0, 1),
    sigma ~ dunif( 0, 10)
  ), data=d
)
precis(m7.2)
</code></pre>

<pre><code>##        Mean StdDev  5.5% 94.5%
## a      9.18   0.14  8.97  9.40
## bA    -1.85   0.22 -2.20 -1.50
## bR    -0.18   0.08 -0.31 -0.06
## bAR    0.35   0.13  0.14  0.55
## sigma  0.93   0.05  0.85  1.01
</code></pre>

<pre><code class="language-r">plot( coeftab( m7.1, m7.2 ), pars=c(&quot;bA&quot;, &quot;bR&quot;, &quot;bAR&quot;))
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-12-1.png" alt="" /></p>

<p>Most of the coefficients are still very close to each other, we can see some small change though for the parameter for the Africa dummy-variable and for the interaction between ruggedness and Africa. The parameter <img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7B%5Ctext%7BAfrica%7D%7D" alt="\\beta\_{\\text{Africa}}" title="\beta_{\text{Africa}}" /> decreased, meaning removing the Seychelles decreased the mean for GDP for Africa. The interaction coefficient <img src="https://latex.codecogs.com/png.latex?%5Cbeta_%7BAR%7D" alt="\\beta\_{AR}" title="\beta_{AR}" /> decreased a bit and thus shrank a bit closer to zero. Let&rsquo;s rearrange the coefficients for ruggedness and the interaction to one Gamma: <img src="https://latex.codecogs.com/png.latex?%5Cgamma%20%3D%20%5Cbeta_R%20%2B%20%5Cbeta_%7BAR%7D%20%5Ctexttt%7Bcont_africa%7D" alt="\\gamma = \\beta\_R + \\beta\_{AR} \\texttt{cont\_africa}" title="\gamma = \beta_R + \beta_{AR} \texttt{cont_africa}" /></p>

<pre><code class="language-r">post &lt;- extract.samples(m7.1)
gamma.Africa &lt;- post$bR + post$bAR*1
gamma.notAfrica &lt;- post$bR + post$bAR*0

mean(gamma.Africa)
</code></pre>

<pre><code>## [1] 0.06566328
</code></pre>

<p>Before, this was about 0.16.</p>

<pre><code class="language-r">mean(gamma.notAfrica)
</code></pre>

<pre><code>## [1] -0.1849966
</code></pre>

<p>Comparing the distributions:</p>

<pre><code class="language-r">dens( gamma.Africa, xlim=c(-0.5, 0.6), ylim=c(0, 5.5),
      xlab=&quot;gamma&quot;, col=&quot;steelblue&quot; )
dens( gamma.notAfrica, add=TRUE )
legend(&quot;topright&quot;, col=c(&quot;black&quot;, &quot;steelblue&quot;), bty=&quot;n&quot;, 
       legend=c(&quot;not Africa&quot;, &quot;Africa&quot;), lty=c(1,1))
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-15-1.png" alt="" /></p>

<p>There is now much more overlap between the two distributions than before and the distribution of the Africa parameter has more density mass around 0 than before.</p>

<pre><code class="language-r">diff &lt;- gamma.Africa - gamma.notAfrica
mean(diff &lt; 0)
</code></pre>

<pre><code>## [1] 0.0326
</code></pre>

<p>The probability that the parameter for Africa is smaller than the parameter for Not Africa is still very low though.</p>

<p>Compare with the model including the Seychelles:</p>

<pre><code class="language-r">post1 &lt;- extract.samples(m7.2)
gamma.Africa1 &lt;- post1$bR + post1$bAR*1
gamma.notAfrica1 &lt;- post1$bR + post1$bAR*0

mean(gamma.Africa1)
</code></pre>

<pre><code>## [1] 0.1635209
</code></pre>

<pre><code class="language-r">mean(gamma.notAfrica1)
</code></pre>

<pre><code>## [1] -0.1837993
</code></pre>

<pre><code class="language-r">dens( gamma.Africa1, xlim=c(-0.5, 0.6), ylim=c(0, 5.5),
      xlab=&quot;gamma&quot;, col=&quot;steelblue&quot; )
dens( gamma.notAfrica1, add=TRUE )
legend(&quot;topright&quot;, col=c(&quot;black&quot;, &quot;steelblue&quot;), bty=&quot;n&quot;, 
       legend=c(&quot;not Africa&quot;, &quot;Africa&quot;), lty=c(1,1))
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-19-1.png" alt="" /></p>

<p>These results suggest, that without the Seychelles, there is more uncertainty, if ruggedness has a positive or any effect on GDP in Africa. The conclusion that the relationship between ruggedness and GDP differs inside and outside of Africa still holds with high probability.</p>

<ol>
<li>Plot the predictions of the interaction model, with and without Seychelles. Does it still seem like the effect of ruggedness depends upon continent? How much has the expected relationship changed?</li>
</ol>

<pre><code class="language-r">d.A1 &lt;- d[d$cont_africa == 1,]
d.A0 &lt;- d[d$cont_africa ==0,]
rug.seq &lt;- seq(from=-1, to=8, length.out = 30)
mu.Africa &lt;- link( m7.1, data=data.frame(cont_africa=1, rugged=rug.seq))
</code></pre>

<pre><code>## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]
</code></pre>

<pre><code class="language-r">mu.Africa.mean &lt;- apply(mu.Africa, 2, mean)
mu.Africa.PI &lt;- apply(mu.Africa, 2, PI)

mu.NotAfrica &lt;- link( m7.1, data=data.frame(cont_africa=0, rugged=rug.seq))
</code></pre>

<pre><code>## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]
</code></pre>

<pre><code class="language-r">mu.NotAfrica.mean &lt;- apply(mu.NotAfrica, 2, mean)
mu.NotAfrica.PI &lt;- apply(mu.NotAfrica, 2, PI )



mu.Africa1 &lt;- link( m7.2, data=data.frame(cont_africa=1, rugged=rug.seq))
</code></pre>

<pre><code>## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]
</code></pre>

<pre><code class="language-r">mu.Africa1.mean &lt;- apply(mu.Africa1, 2, mean)
mu.Africa1.PI &lt;- apply(mu.Africa1, 2, PI)

mu.NotAfrica1 &lt;- link( m7.2, data=data.frame(cont_africa=0, rugged=rug.seq))
</code></pre>

<pre><code>## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]
</code></pre>

<pre><code class="language-r">mu.NotAfrica1.mean &lt;- apply(mu.NotAfrica1, 2, mean)
mu.NotAfrica1.PI &lt;- apply(mu.NotAfrica1, 2, PI )

par(mfrow=c(2,2))
plot( log_gdp ~ rugged, data=d.A1[d.A1$country != &quot;Seychelles&quot;,],
      col=&quot;steelblue&quot;, ylab=&quot;log GDP year 2000&quot;,
      xlab=&quot;Terrain Ruggedness Index&quot;)
mtext(&quot;African nations (without Seychelles)&quot;)
lines(rug.seq, mu.Africa.mean, col=&quot;steelblue&quot;)
shade( mu.Africa.PI, rug.seq, col=col.alpha(&quot;steelblue&quot;))

plot( log_gdp ~ rugged, data=d.A0,
      col=&quot;black&quot;, ylab=&quot;log GDP year 2000&quot;,
      xlab=&quot;Terrain Rugggedness Index&quot;)
mtext( &quot;Non-African nations&quot;, 3)
lines( rug.seq, mu.NotAfrica.mean )
shade( mu.NotAfrica.PI, rug.seq )


plot( log_gdp ~ rugged, data=d.A1,
      col=&quot;steelblue&quot;, ylab=&quot;log GDP year 2000&quot;,
      xlab=&quot;Terrain Ruggedness Index&quot;)
points(log_gdp ~ rugged, data=d[d$country==&quot;Seychelles&quot;,], col=col.desat(&quot;red&quot;))
text(d[d$country==&quot;Seychelles&quot;, &quot;rugged&quot;], d[d$country==&quot;Seychelles&quot;, &quot;log_gdp&quot;], 
     labels=&quot;Seychelles&quot;, pos=1, col=col.desat(&quot;red&quot;))
mtext(&quot;African nations (with Seychelles)&quot;)
lines(rug.seq, mu.Africa1.mean, col=&quot;steelblue&quot;)
shade( mu.Africa1.PI, rug.seq, col=col.alpha(&quot;steelblue&quot;))

plot( log_gdp ~ rugged, data=d.A0,
      col=&quot;black&quot;, ylab=&quot;log GDP year 2000&quot;,
      xlab=&quot;Terrain Rugggedness Index&quot;)
mtext( &quot;Non-African nations&quot;, 3)
lines( rug.seq, mu.NotAfrica1.mean )
shade( mu.NotAfrica1.PI, rug.seq )
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-20-1.png" alt="" /></p>

<p>Comparing the prediction plots, the effect of ruggedness still does seem to depend upon continent but one can see how adding the Seychelles in, changed the regression line upwards.</p>

<ol>
<li><p>Conduct a model comparison analysis, using WAIC. Fit three models to the data without Seychelles:</p>

<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%2A%7D%0A%5Ctext%7BModel%201%7D%20%5C%3B%20%3A%20y_i%20%26%5Csim%20%5Ctext%7BNormal%7D%28%5Cmu_i%2C%20%5Csigma%29%20%5C%5C%0A%5Cmu_i%20%26%3D%20%5Calpha%20%2B%20%5Cbeta_R%20R_i%20%5C%5C%0A%5Ctext%7BModel%202%7D%20%5C%3B%20%3A%20y_i%20%26%5Csim%20%5Ctext%7BNormal%7D%28%5Cmu_i%2C%20%5Csigma%29%20%5C%5C%0A%5Cmu_i%20%26%3D%20%5Calpha%20%2B%20%5Cbeta_A%20A_i%20%2B%20%20%5Cbeta_R%20R_i%20%5C%5C%0A%5Ctext%7BModel%203%7D%20%5C%3B%20%3A%20y_i%20%26%5Csim%20%5Ctext%7BNormal%7D%28%5Cmu_i%2C%20%5Csigma%29%20%5C%5C%0A%5Cmu_i%20%26%3D%20%5Calpha%20%2B%20%5Cbeta_A%20A_i%20%2B%20%20%5Cbeta_R%20R_i%20%2B%20%5Cbeta_%7BAR%7DA_i%20R_i%20%0A%5Cend%7Balign%2A%7D &quot;begin{align*}
text{Model 1} ; : y_i &amp;sim text{Normal}(mu_i, sigma" alt="\\begin{align\*}
\\text{Model 1} \\; : y\_i &amp;\\sim \\text{Normal}(\\mu\_i, \\sigma) \\\\
\\mu\_i &amp;= \\alpha + \\beta\_R R\_i \\\\
\\text{Model 2} \\; : y\_i &amp;\\sim \\text{Normal}(\\mu\_i, \\sigma) \\\\
\\mu\_i &amp;= \\alpha + \\beta\_A A\_i +  \\beta\_R R\_i \\\\
\\text{Model 3} \\; : y\_i &amp;\\sim \\text{Normal}(\\mu\_i, \\sigma) \\\\
\\mu\_i &amp;= \\alpha + \\beta\_A A\_i +  \\beta\_R R\_i + \\beta\_{AR}A\_i R\_i 
\\end{align\*}" /> <br />
\mu_i &amp;= \alpha + \beta_R R_i <br />
\text{Model 2} \; : y_i &amp;\sim \text{Normal}(\mu_i, \sigma) <br />
\mu_i &amp;= \alpha + \beta_A A_i +  \beta_R R_i <br />
\text{Model 3} \; : y_i &amp;\sim \text{Normal}(\mu_i, \sigma) <br />
\mu_i &amp;= \alpha + \beta_A A_i +  \beta_R R<em>i + \beta</em>{AR}A_i R_i
\end{align*}&ldquo;)</p>

<p>Use whatever priors you think are sensible. Plot the model-averaged predictions of this model set. Do your inferences differ from those in (b)?</p></li>
</ol>

<pre><code class="language-r">m7.3 &lt;- map(
  alist(
    log_gdp ~ dnorm( mu, sigma),
    mu &lt;- a + bR*rugged,
    a ~ dnorm(8, 100),
    bR ~ dnorm(0, 1),
    sigma ~ dunif(0, 10)
  ), data=d1
)

m7.4 &lt;- map(
  alist(
    log_gdp ~ dnorm( mu, sigma),
    mu &lt;- a + bR*rugged + bA*cont_africa,
    a ~ dnorm(8, 100),
    bR ~ dnorm(0, 1),
    bA ~ dnorm(0, 1),
    sigma ~ dnorm(0, 10)
  ), data=d1
)

m7.5 &lt;- map(
  alist(
    log_gdp ~ dnorm( mu, sigma),
    mu &lt;- a + bR*rugged + bA*cont_africa + bAR*cont_africa*rugged,
    a ~ dnorm(8, 100),
    bR ~ dnorm(0, 1),
    bA ~ dnorm(0, 1),
    bAR ~ dnorm(0, 1),
    sigma ~ dunif( 0, 10)
  ), data=d1
)

compare(m7.3, m7.4, m7.5)
</code></pre>

<pre><code>##       WAIC pWAIC dWAIC weight    SE   dSE
## m7.5 463.6   4.7   0.0   0.78 15.10    NA
## m7.4 466.2   4.0   2.5   0.22 14.34  3.39
## m7.3 536.4   2.8  72.7   0.00 13.34 15.33
</code></pre>

<p>Now, most of the weight is on the model with the interaction. It also has the lowest WAIC. Including the Africa variable as a dummy variable gives a lower WAIC than only using ruggedness as predictor variable.</p>

<pre><code class="language-r">plot( compare( m7.3, m7.4, m7.5))
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-22-1.png" alt="" /></p>

<p>There is quite a bit of uncertainty if the interaction model has a lower WAIC than the model with just the dummy variable.</p>

<p>Plotting the model-averaged predictions:</p>

<pre><code class="language-r">rugged.Africa.ensemble &lt;- ensemble( m7.3, m7.4, m7.5, data=data.frame(cont_africa=1, rugged=rug.seq))
</code></pre>

<pre><code>## Constructing posterior predictions

## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]

## Constructing posterior predictions

## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]

## Constructing posterior predictions

## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]
</code></pre>

<pre><code class="language-r">mu.Africa.mean &lt;- apply(rugged.Africa.ensemble$link, 2, mean)
mu.Africa.PI &lt;- apply(rugged.Africa.ensemble$link, 2, PI)
log_gdp.Africa.PI &lt;- apply(rugged.Africa.ensemble$sim, 2, PI )

rugged.notAfrica.ensemble &lt;- ensemble(m7.3, m7.4, m7.5, data=data.frame(cont_africa=0, rugged=rug.seq))
</code></pre>

<pre><code>## Constructing posterior predictions

## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]

## Constructing posterior predictions

## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]

## Constructing posterior predictions

## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]
</code></pre>

<pre><code class="language-r">mu.NotAfrica.mean &lt;-apply(rugged.notAfrica.ensemble$link, 2, mean)
mu.NotAfrica.PI &lt;- apply(rugged.notAfrica.ensemble$link,2, PI)
log_gdp.NotAfrica.PI &lt;- apply(rugged.notAfrica.ensemble$sim, 2, PI)

par(mfrow=c(1,2))
plot( log_gdp ~ rugged, data=d.A1[d.A1$country != &quot;Seychelles&quot;,],
      col=&quot;steelblue&quot;, ylab=&quot;log GDP year 2000&quot;,
      xlab=&quot;Terrain Ruggedness Index&quot;)
mtext(&quot;African nations (without Seychelles)&quot;)
lines(rug.seq, mu.Africa.mean, col=&quot;steelblue&quot;)
shade( mu.Africa.PI, rug.seq, col=col.alpha(&quot;steelblue&quot;))
# shade( log_gdp.Africa.PI, rug.seq, col=col.alpha(&quot;steelblue&quot;))

plot( log_gdp ~ rugged, data=d.A0,
      col=&quot;black&quot;, ylab=&quot;log GDP year 2000&quot;,
      xlab=&quot;Terrain Rugggedness Index&quot;)
mtext( &quot;Non-African nations&quot;, 3)
lines( rug.seq, mu.NotAfrica.mean )
shade( mu.NotAfrica.PI, rug.seq )
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-23-1.png" alt="" /></p>

<pre><code class="language-r"># shade( log_gdp.NotAfrica.PI, rug.seq)
</code></pre>

<p>The slope for ruggedness for Africa nations seem to have got even a bit closer to zero and there is quite some uncertainty about the regression line. The uncertainty ribbon would for example also include the regression line with the same slope as the one for non-Africa nations. These models suggest, that one cannot conclude that there is a positive relationship between ruggedness and GDP in African nations.</p>

<p><strong>7H4.</strong> The data set <code>data(nettle)</code> is data on language diversity in 74 nations. Evaluate the hypothesis that language diversity is partly a product of food security. The notion is that, in productive ecologies, people don&rsquo;t need large social networks to buffer them against risk of food shortfalls and thus ethnic groups can be smaller and more self-sufficient.</p>

<pre><code class="language-r">data(nettle)
d &lt;- nettle
str(d)
</code></pre>

<pre><code>## 'data.frame':    74 obs. of  7 variables:
##  $ country            : Factor w/ 74 levels &quot;Algeria&quot;,&quot;Angola&quot;,..: 1 2 3 4 5 6 7 8 9 12 ...
##  $ num.lang           : int  18 42 234 37 52 38 27 209 75 94 ...
##  $ area               : int  2381741 1246700 7713364 143998 112622 1098581 581730 8511965 274000 622984 ...
##  $ k.pop              : int  25660 10303 17336 118745 4889 7612 1348 153322 9242 3127 ...
##  $ num.stations       : int  102 50 134 20 7 48 10 245 6 13 ...
##  $ mean.growing.season: num  6.6 6.22 6 7.4 7.14 6.92 4.6 9.71 5.17 8.08 ...
##  $ sd.growing.season  : num  2.29 1.87 4.17 0.73 0.99 2.5 1.69 5.87 1.07 1.21 ...
</code></pre>

<p>Specifically, try to model the number of languages per capita as the outcome variable:</p>

<pre><code class="language-r">d$lang.per.cap &lt;- d$num.lang / d$k.pop
d$log.lang &lt;- log( d$lang.per.cap)
</code></pre>

<p>where <code>num.lang</code> is the number of languages spoken and <code>k.pop</code> is the population in thousands. We will use the predictor variables <code>mean.growing.season</code>, the average length of growing season in months and <code>sd.growing.season</code>, the standard deviation of length of growing season, in months, and their interactions.</p>

<ol>
<li>Evaluate the hypothesis that language diversity, as measured by <code>log(lang.per.cap)</code> is positively associated with the average length of the growing season. Consider <code>log(area)</code> as a covariate.</li>
</ol>

<p>We first center the variables used as predictor variables. The lowest value a country could have for languages per capita would be only one language for ~1.5 billion people (most populated country in the world: China). The ratio of this is ~6.7e-10 which on log scale (and counting population in thousands) translates to about -12 and the maximum value would be each thousand people speaks a different language (very unlikely), as ratio this is 1, so on log scale 0. I expect most countries to be in between these extremes, so the prior for the intercept is <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Csim%20%5Ctext%7BNormal%7D%28-5%2C%2010%29 &quot;alpha sim text{Normal}(-5, 10" alt="\\alpha \\sim \\text{Normal}(-5, 10)" />&rdquo;), allowing values between -25 and 20. For the parameters, I use weakly regularizing priors <img src="https://latex.codecogs.com/png.latex?%5Cbeta%20%5Csim%20%5Ctext%7BNormal%7D%280%2C1%29 &quot;beta sim text{Normal}(0,1" alt="\\beta \\sim \\text{Normal}(0,1)" />&rdquo;).</p>

<pre><code class="language-r">d$log.area &lt;- log(d$area)
d$mean.growing.season.c &lt;- d$mean.growing.season - mean(d$mean.growing.season)
d$log.area.c &lt;- d$log.area - mean(d$log.area)

m7.1 &lt;- map(
  alist(
    log.lang ~ dnorm( mu, sigma),
    mu &lt;- a + bM*mean.growing.season.c,
    a ~ dnorm(-5, 10),
    bM ~ dnorm(0, 1),
    sigma ~ dunif(0, 10)
  ), data=d
)
m7.2 &lt;- map(
  alist( 
    log.lang ~ dnorm( mu, sigma),
    mu &lt;- a + bM*mean.growing.season.c + bA*log.area.c,
    a ~ dnorm(-5, 10),
    bM ~ dnorm(0, 1),
    bA ~ dnorm(0, 1),
    sigma ~ dunif(0, 10)
    ), data=d
)
coeftab(m7.1, m7.2 )
</code></pre>

<pre><code>##       m7.1    m7.2   
## a       -5.46   -5.46
## bM       0.17    0.14
## sigma    1.41    1.39
## bA         NA    -0.2
## nobs       74      74
</code></pre>

<pre><code class="language-r">plot( coeftab( m7.1, m7.2 ), pars=c(&quot;bM&quot;, &quot;bA&quot;))
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-27-1.png" alt="" /></p>

<p>The parameter for area has a huge uncertainty, so seems to not have a influence on our target variable. Including area leads to a slight decrease in the parameter for the mean length of growing season. For both models, the mean length of growing season is positively associated with the number of languages per capita.</p>

<pre><code class="language-r">compare( m7.1, m7.2)
</code></pre>

<pre><code>##       WAIC pWAIC dWAIC weight    SE  dSE
## m7.1 267.5   3.5   0.0   0.63 15.09   NA
## m7.2 268.6   5.2   1.1   0.37 15.93 3.54
</code></pre>

<pre><code class="language-r">plot( compare( m7.1, m7.2 ))
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-29-1.png" alt="" /></p>

<p>WAIC does not favor any of the two models, so adding the area doesn&rsquo;t seem to bring big improvements to the model.</p>

<pre><code class="language-r">mean.g.s.seq &lt;- seq(from=-8, to=6, length.out = 50)
mu &lt;- link(m7.1, data=data.frame(mean.growing.season.c=mean.g.s.seq ) )
</code></pre>

<pre><code>## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]
</code></pre>

<pre><code class="language-r">mu.mean &lt;- apply(mu, 2, mean)
mu.PI &lt;- apply(mu, 2, PI)

plot( log.lang ~ mean.growing.season.c, data=d,
      xlab=&quot;Mean lenght of growing season (centered)&quot;,
      ylab=&quot;log languages per capita&quot;)
lines(mean.g.s.seq, mu.mean)
shade(mu.PI, mean.g.s.seq)
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-30-1.png" alt="" /></p>

<ol>
<li>Evaluate the hypothesis that language diversity is negatively associated with the standard deviation of length of growing season.</li>
</ol>

<pre><code class="language-r">d$sd.growing.season.c &lt;- d$sd.growing.season - mean(d$sd.growing.season)
m7.3 &lt;- map(
  alist(
    log.lang ~ dnorm(mu, sigma),
    mu &lt;- a + bS*sd.growing.season.c,
    a ~ dnorm(-5, 10),
    bS ~ dnorm(0, 1),
    sigma ~ dunif(0, 10)
  ), data=d
)

m7.4 &lt;- map(
  alist(
    log.lang ~ dnorm( mu, sigma),
    mu &lt;- a + bS*sd.growing.season.c + bA*log.area.c,
    a ~ dnorm( -5, 10),
    bS ~ dnorm( 0, 1),
    bA ~ dnorm( 0, 1),
    sigma ~ dunif( 0, 10)
  ), data=d
)
coeftab(m7.3, m7.4)
</code></pre>

<pre><code>##       m7.3    m7.4   
## a       -5.46   -5.46
## bS      -0.35   -0.21
## sigma    1.46    1.44
## bA         NA   -0.24
## nobs       74      74
</code></pre>

<pre><code class="language-r">plot( coeftab( m7.3, m7.4 ), pars=c(&quot;bS&quot;, &quot;bA&quot;))
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-32-1.png" alt="" /></p>

<pre><code class="language-r">cor(d$sd.growing.season, d$log.area)
</code></pre>

<pre><code>## [1] 0.5320083
</code></pre>

<p>There seems to be some collinearity between standard deviation of growing season and the area. This makes sense if the length of the growing season can also vary quite a bit inside a country if the country is large (consider for example Brazil or Australia, both having area that ranges through different climate zones, like desert and rain forests).</p>

<p>Without the area, the standard deviation of length of growing season has a negative impact on language diversity.</p>

<pre><code class="language-r">compare(m7.3, m7.4)
</code></pre>

<pre><code>##       WAIC pWAIC dWAIC weight    SE  dSE
## m7.3 273.0   3.6   0.0    0.6 16.91   NA
## m7.4 273.8   5.3   0.8    0.4 16.88 3.88
</code></pre>

<pre><code class="language-r">plot(compare( m7.3, m7.4))
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-35-1.png" alt="" /></p>

<p>Again, both models have almost identical WAIC and both get half of the weight.</p>

<pre><code class="language-r">sd.g.s.seq &lt;- seq(from=-2, to=5, length.out = 50)
mu &lt;- link(m7.3, data=data.frame(sd.growing.season.c=sd.g.s.seq ) )
</code></pre>

<pre><code>## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]
</code></pre>

<pre><code class="language-r">mu.mean &lt;- apply(mu, 2, mean)
mu.PI &lt;- apply(mu, 2, PI)

plot( log.lang ~ sd.growing.season.c, data=d,
      xlab=&quot;Standard deviation of lenght of growing season (centered)&quot;,
      ylab=&quot;log languages per capita&quot;)
lines(sd.g.s.seq, mu.mean)
shade(mu.PI, sd.g.s.seq)
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-36-1.png" alt="" /></p>

<p>From the model, we can conclude a very slight negative association of standard deviation of length of growing season on the language diversity.</p>

<ol>
<li>Evaluate the hypothesis, that the average length of growing season and the standard deviation of length of growing season interact to synergistically reduce language diversity.</li>
</ol>

<pre><code class="language-r">m7.5 &lt;- map(
  alist(
    log.lang ~ dnorm( mu, sigma),
    mu &lt;- a + bM*mean.growing.season.c + bS*sd.growing.season.c + bMS*sd.growing.season.c*mean.growing.season.c,
    a ~ dnorm( -5, 10),
    bM ~ dnorm(0 , 1),
    bS ~ dnorm(0, 1),
    bMS ~ dnorm(0, 1),
    sigma ~ dunif( 0, 10)
  ), data=d
)
precis(m7.5)
</code></pre>

<pre><code>##        Mean StdDev  5.5% 94.5%
## a     -5.45   0.15 -5.69 -5.21
## bM     0.11   0.06  0.03  0.20
## bS    -0.34   0.14 -0.57 -0.11
## bMS   -0.11   0.05 -0.18 -0.03
## sigma  1.31   0.11  1.14  1.48
</code></pre>

<pre><code class="language-r">plot( coeftab( m7.1, m7.3, m7.5), pars=c(&quot;bM&quot;, &quot;bS&quot;, &quot;bMS&quot;))
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-38-1.png" alt="" /></p>

<p>Plotting the interaction. Since we don&rsquo;t have discrete values as in the example in the chapter before, I only pick a subset of values for which to make a (counterfactual) plot.</p>

<pre><code class="language-r">par(mfrow=c(1,4))
for (s in -1:2) {
  plot( log.lang ~ mean.growing.season.c, data=d,
        col=&quot;steelblue&quot;, type=&quot;n&quot;,
        main=paste(&quot;sd.growing.season.c=&quot;,s),
        xlab=&quot;mean growing season (centered)&quot;,
        ylim=c(-8, -4))
  mu &lt;- link( m7.5, data= data.frame(mean.growing.season.c=mean.g.s.seq,
                                     sd.growing.season.c=s))
  mu.mean &lt;- apply( mu, 2, mean)
  mu.PI &lt;- apply( mu, 2, PI )
  lines( mean.g.s.seq, mu.mean )
  lines( mean.g.s.seq, mu.PI[1,], lty=2)
  lines( mean.g.s.seq, mu.PI[2,], lty=2)
}
</code></pre>

<pre><code>## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]

## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]

## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-39-1.png" alt="" /></p>

<pre><code>## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]
</code></pre>

<p>For a very low standard deviation of length of growing season, the mean length is strongly positively associated with diversity of languages. With a growing standard deviation, this association decreases, so that for a very high standard deviation the association even reverses to a negative one. This fits with the proposed theory, that if the average length of growing season is long and the standard deviation is large as well, then it is crucial to store and redistribute food in years of a long growing season, thus fostering corporation and larger networks.</p>

<pre><code class="language-r">par(mfrow=c(1,4))
for (m in c(-2,0,2,4)) {
  plot( log.lang ~ sd.growing.season.c, data=d,
        col=&quot;steelblue&quot;, type=&quot;n&quot;,
        main=paste(&quot;mean.growing.season.c=&quot;,m),
        xlab=&quot;standard deviation growing season (centered)&quot;,
        ylim=c(-8, -4))
  mu &lt;- link( m7.5, data= data.frame(mean.growing.season.c=m,
                                     sd.growing.season.c=sd.g.s.seq))
  mu.mean &lt;- apply( mu, 2, mean)
  mu.PI &lt;- apply( mu, 2, PI )
  lines( mean.g.s.seq, mu.mean )
  lines( mean.g.s.seq, mu.PI[1,], lty=2)
  lines( mean.g.s.seq, mu.PI[2,], lty=2)
}
</code></pre>

<pre><code>## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]

## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]

## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]
</code></pre>

<p><img src="chapter7_Ex_files/figure-markdown_github/unnamed-chunk-40-1.png" alt="" /></p>

<pre><code>## [ 100 / 1000 ]
[ 200 / 1000 ]
[ 300 / 1000 ]
[ 400 / 1000 ]
[ 500 / 1000 ]
[ 600 / 1000 ]
[ 700 / 1000 ]
[ 800 / 1000 ]
[ 900 / 1000 ]
[ 1000 / 1000 ]
</code></pre>

<p>The higher the average length of growing season is, the more negative is the association between the standard deviation of growing season and language diversity.</p>

    
    </section>


  <aside class="read-next">
  
      <a class="read-next-story" style="no-cover" href="/projects/statistical-rethinking/chapter_7/chapter7/">
          <section class="post">
              <h5></h5>
              
          </section>
      </a>
  
  
      <a class="read-next-story prev" style="no-cover" href="/projects/statistical-rethinking/chapter_8/chapter8/">
          <section class="post">
              <h5></h5>
          </section>
      </a>
      

</aside>



  <footer class="post-footer">


    









<section class="author">
  <h4><a href="/">Corrie</a></h4>
  
  <p>Read <a href="/">more posts</a> by this author.</p>
  
  <div class="author-meta">
    
    
  </div>
</section>




    
<section class="share">
  <h4>Share this projects</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=&nbsp;-&nbsp;Samples%20of%20Thoughts&amp;url=%2fprojects%2fstatistical-rethinking%2fchapter_7%2fchapter7_ex%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=421');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=%2fprojects%2fstatistical-rethinking%2fchapter_7%2fchapter7_ex%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=551');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-linkedin" style="font-size: 1.4em" href="https://www.linkedin.com/shareArticle?mini=true&title=&url=%2fprojects%2fstatistical-rethinking%2fchapter_7%2fchapter7_ex%2f"
               onclick="window.open(this.href, 'linkedin-share', 'width=554,height=571');return false;">
    <span class="hidden">LinkedIn</span>
    </a>

</section>




    

<div id="disqus_thread"></div>
<script>




var disqus_config = function () {
this.page.url = "\/projects\/statistical-rethinking\/chapter_7\/chapter7_ex\/";  
this.page.identifier = "\/projects\/statistical-rethinking\/chapter_7\/chapter7_ex\/"; 
};

(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://corriebar-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>








  </footer>
</article>

</main>



    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Samples of Thoughts</a> 
        &copy; Corrie Bartelheimer 2020 &middot; </section>
        
    </footer>
    </div>
    <script type="text/javascript" src="/js/jquery.js"></script>
    <script type="text/javascript" src="/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/js/index.js"></script>
    
    



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>


    
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
    });
    </script>
    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML">
</script>


    
    
<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-140745376-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>


    
</body>
</html>

